Catalog-service on the OpenShift example
----------------------------------------

* * * * *

We have covered a lot of theory in this chapter and have introduced many
concepts that will help you to better understand how OpenShift works
under the hood. It is finally time to try it in practice.

We will deploy a `catalog-service` with a `h2`
database. In this example, we will only use the web console and deploy
the applications from the book's code repository.

### Note

Examples reference: `chapter6/catalog-service-openshift-h2`

You can access the `OpenShift Web Console` by clicking `Dashboard` tab located right to the terminal window. You will be welcomed by the user login screen. Let's enter our
**`Username`** and **`Password`**.

Use the `developer` user, with `developer` password, to log in on the welcome page. We will be directed to the welcome screen, as follows:

![](https://github.com/athertahir/katacoda-scenarios/raw/master/cloud-development-with-wildfly/cloud-development-with-wildfly-chapter-06-02/images/903dcc75-41b3-4f76-b107-1b0a43cd449b.png)


Click `New Project` and add following data to create new project:

**Name:** `petstore`{{copy}}

**Display Name:** `petstore`{{copy}}

Enter **petstore** as the name of the project. In order to deploy
catalog-service to OpenShift, we will use the source-to-image build
using the CLI. To start with, ensure that you have logged in to the
cluster, as follows:

`oc login -u developer -p developer`{{execute}}

# Output

```
Login successful.
```

Then, you need to execute the following command:

`oc create -f https://raw.githubusercontent.com/wildfly-swarm/sti-wildflyswarm/master/1.0/wildflyswarm-sti-all.json`{{execute}}

The preceding command creates a bunch of OpenShift objects that are
necessary to start an OpenShift build.

**Important:** Please wait for build to comeplete before starting application. You can get build status by running  `oc get build --watch`{{execute}}

Finally, it is time to start an application:

`oc new-app wildflyswarm-10-centos7~https://github.com/PacktPublishing/Hands-On-Cloud-Development-with-WildFly.git --context-dir=chapter6/catalog-service-openshift-h2/ --name=catalog-service`{{execute}}

We are fully aware that, at this point, these commands look cryptic. For
some time, we will use them as a magical service deployment spell. Don't
worry though, in [Chapter
8](https://subscription.packtpub.com/book/web_development/9781786462374/8),
*Scaling and Connecting Your Services*, they will be fully explained,
and you will be able to understand each part of the process. To give you
a quick overview now: we are making OpenShift create a build of our
service directly from source code. In order to do that, we have to
specify the GitHub repository. Because our book repository contains many
subdirectories, we have to specify the subdirectory in which this
example is located—we use `--context-dir` for that. We also
provide the name, using the `--name` command.

For now, let's use the web console to check whether the application has
been deployed.

Login to the web console again and navigate to
**`Builds | `****`Builds`** on the left-hand side. You will be able to
see that the build has indeed started:

![](https://github.com/athertahir/katacoda-scenarios/raw/master/cloud-development-with-wildfly/cloud-development-with-wildfly-chapter-06-02/images/02bf57a3-684c-48b9-8b31-83fafffc94bd.jpg)

Wait till the build has finished, then navigate to
**`Applications | `****`Services`**, and select **`catalog-service`**:

![](https://github.com/athertahir/katacoda-scenarios/raw/master/cloud-development-with-wildfly/cloud-development-with-wildfly-chapter-06-02/images/887fdf34-edfe-41ad-a0e6-2e7c9be5fedb.png)

As you can see in the preceding screenshot, OpenShift has deployed the
application on one pod and made a service for it.

Before we can check the application, we have to do one more simple
thing. The services are not visible outside of the cluster, and as a
result, in order to use them, we have to expose them on the address
visible from the external network. OpenShift provides a tool that
enables us to use these routes. In the preceding view, click on the
**`Create route`** link, don't change anything, and click the
**`Create`** button. After that, you will be able to see the external
address of the service:

![](https://github.com/athertahir/katacoda-scenarios/raw/master/cloud-development-with-wildfly/cloud-development-with-wildfly-chapter-06-02/images/b83ae5a3-0f40-4dce-85c7-2810f8f0982d.png)

Finally, we are ready to check the operation of our service. Copy the
external address of the host and add the REST path to it:

![](https://github.com/athertahir/katacoda-scenarios/raw/master/cloud-development-with-wildfly/cloud-development-with-wildfly-chapter-06-02/images/2cd18746-d056-4cf0-82e6-a189d0c8d912.png)

It works. Congratulations! You have deployed your first service in
OpenShift.
